(()=>{const t=new RegExp("\\S");function n(n){var e=n.textContent;return 0===e.length||!t.test(e)}function e(n){const e=["NOSCRIPT","SCRIPT","STYLE","SELECT"];if(n&&n.nodeType===Node.ELEMENT_NODE){if(!t.test(n.textContent))return!0;if(e.indexOf(n.nodeName.toUpperCase())>-1)return!0}return!1}function r(t,n){for(;n&&n!==t&&!n.nextSibling;)n=n.parentNode;return n&&n!==t?n.nextSibling:null}function i(t,n){return n.hasChildNodes()?n.firstChild:r(t,n)}function o(t,n){for(;n&&n!==t&&!n.previousSibling;)n=n.parentNode;return n&&n!==t?n.previousSibling:null}function u(t,n){return n.hasChildNodes()?n.lastChild:o(t,n)}if(window&&window.external&&window.external.contextMenuSourceElement){let t=window.external.contextMenuSourceElement.ownerDocument;if(t){let f=t.getSelection();if(f){let t=f.toString(),l=t.length,c=f.getRangeAt(0);if(c){let f=(1e3-l)/2;return function t(r,i){var f=i;if(r.startContainer.nodeType===Node.TEXT_NODE&&r.startOffset>0&&!n(r.startContainer)){let t=Math.max(0,r.startOffset-f);f-=r.startOffset-t,r.setStart(r.startContainer,t)}if(f>0){let t=r.startContainer.nodeType===Node.ELEMENT_NODE?r.startContainer.childNodes[r.startOffset]:r.startContainer,i=function(t,r){let i=r;do{i=e(i)?o(t,i):u(t,i)}while(i&&(i.nodeType!==Node.TEXT_NODE||n(i)));return i!==r?i:null}(t.ownerDocument.body,t);if(i&&!n(i)){let t=i.textContent.length,n=Math.max(0,t-f);f-=t-n,r.setStart(i,n)}}var l=f<i;return l&&f>0&&t(r,f),l}(c,f),function t(o,u){var f=u;if(o.endContainer.nodeType===Node.TEXT_NODE){let t=o.endContainer.textContent.length;if(o.endOffset<t&&!n(o.endContainer)){let n=Math.min(o.endOffset+f,t);f-=n-o.endOffset,o.setEnd(o.endContainer,n)}}if(f>0){let t=o.endContainer.nodeType===Node.ELEMENT_NODE?o.endContainer.childNodes[o.endOffset-1]:o.endContainer,u=function(t,o){let u=o;do{u=e(u)?r(t,u):i(t,u)}while(u&&(u.nodeType!==Node.TEXT_NODE||n(u)));return u!==o?u:null}(t.ownerDocument.body,t);if(u&&!n(u)){let t=Math.min(f,u.textContent.length);f-=t,o.setEnd(u,t)}}var l=f<u;return l&&f>0&&t(o,f),l}(c,f),JSON.stringify({selectionText:t,selectionTextContext:c.toString()})}}}}})();